<!doctype html><html>
<head>
<title>Installing Prometheus</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="ie=edge">
<link rel=stylesheet href=/css/bootstrap.min.css>
<link rel=stylesheet href=/css/layouts/main.css>
<link rel=stylesheet href=/css/navigators/navbar.css>
<link rel=stylesheet href=/css/plyr.css>
<link rel=stylesheet href=/css/flag-icon.min.css>
<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css>
<meta property="og:title" content="Installing Prometheus">
<meta property="og:description" content="Create a User sudo useradd -rs /bin/false prometheus sudo mkdir /etc/prometheus sudo mkdir /var/lib/prometheus sudo chown prometheus:prometheus /etc/prometheus sudo chown prometheus:prometheus /var/lib/prometheus Download Prometheus cd /tmp wget https://github.com/prometheus/prometheus/releases/download/v2.13.1/prometheus-2.13.1.linux-amd64.tar.gz tar -xzvf prometheus-2.13.1.linux-amd64.tar.gz prometheus/ sudo mv prometheus/prometheus /usr/local/bin/ sudo mv prometheus/promtool /usr/local/bin/ sudo chown prometheus:prometheus /usr/local/bin/prometheus sudo chown prometheus:prometheus /usr/local/bin/prometheus Configure Prometheus sudo vim /etc/prometheus/prometheus.yml global: scrape_interval: 15s evaluation_interval: 15s rule_files: # - &#34;first.rules&#34; # - &#34;second.rules&#34; scrape_configs: - job_name: 'prometheus' scrape_interval: 5s static_configs: - targets: ['localhost:9090'] sudo chown prometheus:prometheus /etc/prometheus/prometheus.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://resettech.net/posts/monitoring/prom_install/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-10-03T00:00:00+00:00">
<meta property="article:modified_time" content="2021-10-03T00:00:00+00:00">
<meta name=description content="Installing Prometheus">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css>
<link rel=stylesheet href=/css/layouts/single.css>
<link rel=stylesheet href=/css/navigators/sidebar.css>
<link rel=stylesheet href=/css/style.css>
</head>
<body data-spy=scroll data-target=#TableOfContents data-offset=80>
<div class="container-fluid bg-dimmed wrapper">
<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
<div class=container>
<button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/>
Reset_Smith's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse lang-selector" id=top-nav-items>
<ul class="navbar-nav ml-auto">
</ul>
</div>
</div>
</nav>
<section class=sidebar-section id=sidebar-section>
<div class=sidebar-holder>
<div class=sidebar id=sidebar>
<form class=mx-auto method=get action=/search>
<input type=text name=keyword placeholder=Search data-search id=search-box>
</form>
<div class=sidebar-tree>
<ul class=tree id=tree>
<li id=list-heading><a href=/posts data-filter=all>Posts</a></li>
<div class=subtree>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/server_mgmt/>Server Management</a>
<ul>
<li><a href=/posts/server_mgmt/htpasswd/ title="Basic Auth with Apache">Basic Auth with Apache</a></li>
<li><a href=/posts/server_mgmt/add_ssl/ title="Enabling SSL">Enabling SSL</a></li>
</ul>
</li>
<li>
<i class="fas fa-plus-circle"></i><a href=/posts/wordpress/>WordPress</a>
<ul>
<li><a href=/posts/wordpress/new_lamp/ title="Deploying a LAMP server">Deploying a LAMP server</a></li>
<li><a href=/posts/wordpress/migration/ title="WordPress Migrations">WordPress Migrations</a></li>
</ul>
</li>
<li><a href=/posts/hugo/ title=Hugo>Hugo</a></li>
<li>
<i class="fas fa-minus-circle"></i><a class=active href=/posts/monitoring/>Monitoring</a>
<ul class=active>
<li><a class=active href=/posts/monitoring/prom_install/ title="Installing Prometheus">Installing Prometheus</a></li>
<li><a href=/posts/monitoring/promtail/ title="Installing Promtail">Installing Promtail</a></li>
<li><a href=/posts/monitoring/node_exporter/ title="Installing Node Exporter">Installing Node Exporter</a></li>
</ul>
</li>
</div>
</ul>
</div>
</div>
</div>
</section>
<section class=content-section id=content-section>
<div class=content>
<div class="container p-0 read-area">
<div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://resettech.net/posts/monitoring/prom_install/data_security_15.jpg)>
</div>
<div class=page-content>
<div class="author-profile ml-auto align-self-lg-center">
<img class=rounded-circle src=/images/authors/reset_smith_hua4f6218794f907357bf1ed85aa384e41_361770_120x120_fit_q75_box.jpg alt="Author Image">
<h5 class=author-name>Reset_Smith</h5>
<p>October 3, 2021</p>
</div>
<div class=title>
<h1>Installing Prometheus</h1>
</div>
<div class=post-content id=post-content>
<h2 id=create-a-user>Create a User</h2>
<pre tabindex=0><code>sudo useradd -rs /bin/false prometheus
sudo mkdir /etc/prometheus
sudo mkdir /var/lib/prometheus
sudo chown prometheus:prometheus /etc/prometheus
sudo chown prometheus:prometheus /var/lib/prometheus
</code></pre><h2 id=download-prometheus>Download Prometheus</h2>
<pre tabindex=0><code>cd /tmp
wget https://github.com/prometheus/prometheus/releases/download/v2.13.1/prometheus-2.13.1.linux-amd64.tar.gz
tar -xzvf prometheus-2.13.1.linux-amd64.tar.gz prometheus/
sudo mv prometheus/prometheus /usr/local/bin/
sudo mv prometheus/promtool /usr/local/bin/

sudo chown prometheus:prometheus /usr/local/bin/prometheus
sudo chown prometheus:prometheus /usr/local/bin/prometheus
</code></pre><h2 id=configure-prometheus>Configure Prometheus</h2>
<pre tabindex=0><code>sudo vim /etc/prometheus/prometheus.yml
</code></pre><pre tabindex=0><code>global:
  scrape_interval:     15s
  evaluation_interval: 15s

rule_files:
  # - &quot;first.rules&quot;
  # - &quot;second.rules&quot;

scrape_configs:
  - job_name: 'prometheus'
    scrape_interval: 5s
    static_configs:
      - targets: ['localhost:9090']
</code></pre><pre tabindex=0><code>sudo chown prometheus:prometheus /etc/prometheus/prometheus.yml
</code></pre><h2 id=create-service>Create Service</h2>
<pre tabindex=0><code>sudo vim /etc/systemd/system/prometheus.service
</code></pre><pre tabindex=0><code>[Unit]
Description=Prometheus Monitoring
Wants=network-online.target
After=network-online.target

[Service]
User=prometheus
Group=prometheus
Type=simple
ExecStart=/usr/local/bin/prometheus \
--config.file /etc/prometheus/prometheus.yml \
--storage.tsdb.path /var/lib/prometheus/ \

ExecReload=/bin/kill -HUP $MAINPID

[Install]
WantedBy=multi-user.target
</code></pre><pre tabindex=0><code>sudo systemctl start prometheus.service
sudo systemctl status prometheus.service
sudo systemctl enable prometheus.service
</code></pre><h2 id=open-firewall>Open Firewall</h2>
<pre tabindex=0><code>sudo ufw allow 9090
</code></pre><h2 id=install-grafana>Install Grafana</h2>
<pre tabindex=0><code>sudo apt-get install -y apt-transport-https
sudo apt-get install -y software-properties-common wget
wget -q -O - https://packages.grafana.com/gpg.key | sudo apt-key add -
echo &quot;deb https://packages.grafana.com/enterprise/deb stable main&quot; | sudo tee -a /etc/apt/sources.list.d/grafana.list

sudo apt-get update
sudo apt-get install grafana-enterprise
</code></pre><pre tabindex=0><code>sudo systemctl daemon-reload
sudo systemctl start grafana-server
sudo systemctl status grafana-server
sudo systemctl enable grafana-server
</code></pre><p>Check http://localhost:3000
open firewall
admin/admin
Setup reverse proxy in Apache</p>
</div>
<div class="row pl-3 pr-3">
<div class="col-md-6 share-buttons">
</div>
<div class="col-md-6 btn-improve-page">
<a href=https://github.com/ResetSmith/ResetSmith.github.io/edit/main/content/posts/monitoring/prom_install/index.md title="Improve this page" target=_blank rel=noopener>
<i class="fas fa-code-branch"></i>
Improve this page
</a>
</div>
</div>
<hr>
<div class="row next-prev-navigator">
<div class="col-md-6 previous-article">
<a href=/posts/hugo/ title=Hugo class="btn btn-outline-info">
<div><i class="fas fa-chevron-circle-left"></i> Prev</div>
<div class=next-prev-text>Hugo</div>
</a>
</div>
<div class="col-md-6 next-article">
<a href=/posts/monitoring/promtail/ title="Installing PromTail" class="btn btn-outline-info">
<div>Next <i class="fas fa-chevron-circle-right"></i></div>
<div class=next-prev-text>Installing PromTail</div>
</a>
</div>
</div>
<hr>
</div>
</div>
</div>
<a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a>
</section>
<section class=toc-section id=toc-section>
<div class=toc-holder>
<h5 class="text-center pl-3">Table of Contents</h5>
<hr>
<div class=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#create-a-user>Create a User</a></li>
<li><a href=#download-prometheus>Download Prometheus</a></li>
<li><a href=#configure-prometheus>Configure Prometheus</a></li>
<li><a href=#create-service>Create Service</a></li>
<li><a href=#open-firewall>Open Firewall</a></li>
<li><a href=#install-grafana>Install Grafana</a></li>
</ul>
</nav>
</div>
</div>
</section>
</div>
<footer class="container-fluid text-center align-content-center footer pb-2">
<div class="container pt-5">
<div class="row text-left">
<div class="col-md-4 col-sm-12">
<h5>Navigation</h5>
<ul>
</ul>
</div>
<div class="col-md-4 col-sm-12">
<h5>Contact me:</h5>
<ul>
<li><span>Email: </span> <span>johndoe@example.com</span></li>
<li><span>Phone: </span> <span>+0123456789</span></li>
</ul>
</div>
</div>
</div>
<hr>
<div class=container>
<div class="row text-left">
<div class=col-md-4>
<a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener>
<img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha
</a>
</div>
<div class="col-md-4 text-center">© 2021 Copyright.</div>
<div class="col-md-4 text-right">
<a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18>
</a>
</div>
</div>
</div>
</footer>
<script type=text/javascript src=/js/jquery-3.4.1.min.js></script>
<script type=text/javascript src=/js/popper.min.js></script>
<script type=text/javascript src=/js/bootstrap.min.js></script>
<script type=text/javascript src=/js/navbar.js></script>
<script type=text/javascript src=/js/plyr.js></script>
<script type=text/javascript src=/js/main.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script>
<script src=/js/single.js></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>